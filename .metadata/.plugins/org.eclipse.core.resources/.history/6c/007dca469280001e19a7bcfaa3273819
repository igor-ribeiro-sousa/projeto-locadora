package com.pro.services;

import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Arrays;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;
import org.springframework.stereotype.Service;

import com.pro.entities.Usuario;
import com.pro.entities.enums.Perfil;
import com.pro.repositories.PessoaRepository;

@Service
public class DBService
{

   @Autowired
   private PessoaRepository pessoaRepository;

   @Autowired
   private BCryptPasswordEncoder encoder;

   public void instanciaDB() throws ParseException
   {
      SimpleDateFormat fmt = new SimpleDateFormat("dd/MM/yyyy");

      Usuario user1 = new Usuario(null, "Seu Zezinho", "11166189074", "ze@mail.com", encoder.encode("123"), "85985521245", fmt.parse("17/08/1996"), "S");
      user1.addPerfil(Perfil.ADMIN);
      
      Usuario user2 = new Usuario(null, "Raimundinha", "123456789-85", "rai@mail.com", "859123445678",
            fmt.parse("22/09/1989"), "S");
      user2.addPerfil(Perfil.CLIENTE);

      pessoaRepository.saveAll(Arrays.asList(user1, user2));
   }
}
